{
	"info": {
		"_postman_id": "a8949c6f-347d-41b0-87b9-f561cf84792a",
		"name": "VID AUTH",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Auth using VID",
			"item": [
				{
					"name": "resident auth Copy",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"postman.setGlobalVariable('requesttime', (new Date()).toISOString());"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"name": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"id\": \"string\",\r\n  \"metadata\": {},\r\n  \"request\": {\r\n    \"appId\": \"resident\",\r\n    \"clientId\": \"mosip-resident-client\",\r\n    \"secretKey\": \"abc123\"\r\n  },\r\n  \"requesttime\": \"{{requesttime}}\",\r\n  \"version\": \"string\"\r\n}"
						},
						"url": {
							"raw": "{{url}}/v1/authmanager/authenticate/clientidsecretkey",
							"host": [
								"{{url}}"
							],
							"path": [
								"v1",
								"authmanager",
								"authenticate",
								"clientidsecretkey"
							]
						}
					},
					"response": []
				},
				{
					"name": "send OTP 1.1.5 Copy",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"postman.setGlobalVariable('requesttime', (new Date()).toISOString());"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"id\": \"mosip.identity.otp.internal\",\r\n  \"individualId\": \"{{UIN}}\",\r\n  \"individualIdType\": \"UIN\",\r\n  \"metadata\": {},\r\n  \"otpChannel\": [\"PHONE\",\"EMAIL\"],\r\n  \"requestTime\": \"{{requesttime}}\",\r\n  \"transactionID\": \"1234567890\",\r\n  \"version\": \"1.0\"\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{url}}/resident/v1/req/otp",
							"host": [
								"{{url}}"
							],
							"path": [
								"resident",
								"v1",
								"req",
								"otp"
							]
						}
					},
					"response": []
				},
				{
					"name": "Generate VID Copy",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const {response} =pm.response.json();\r",
									"    pm.environment.set('VID', response.vid);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Cookies",
								"value": "Authorization=eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJtdm9YQzNvdHpZT1U2QUl0WEZIODZIM1VrU1pOVjNpeG9zVnAzdXVweURRIn0.eyJqdGkiOiIwZDU1ZDZmNi0xMGJjLTQ1OGItYTc3Ni1hOTRlZDUyOGY0OTYiLCJleHAiOjE2MDI2MDMxNjgsIm5iZiI6MCwiaWF0IjoxNjAyNTY3MTY4LCJpc3MiOiJodHRwczovL3FhLm1vc2lwLm5ldC9rZXljbG9hay9hdXRoL3JlYWxtcy9tb3NpcCIsImF1ZCI6ImFjY291bnQiLCJzdWIiOiI2ZmY1NThlMC0wYzIwLTQxNTYtOWE5MS1hZDZjYjM2MWZmYTIiLCJ0eXAiOiJCZWFyZXIiLCJhenAiOiJtb3NpcC1hZG1pbi1jbGllbnQiLCJhdXRoX3RpbWUiOjAsInNlc3Npb25fc3RhdGUiOiI1YjRhYTRjZS1mZmJmLTRjM2ItODgwNS1lYzFhZjkxYjQzMDIiLCJhY3IiOiIxIiwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbIlJFR0lTVFJBVElPTl9BRE1JTiIsIlJFR0lTVFJBVElPTl9PRkZJQ0VSIiwiUkVHSVNUUkFUSU9OX1NVUEVSVklTT1IiLCJaT05BTF9BRE1JTiIsIk1BU1RFUkRBVEFfQURNSU4iLCJvZmZsaW5lX2FjY2VzcyIsInVtYV9hdXRob3JpemF0aW9uIiwiR0xPQkFMX0FETUlOIiwiSU5ESVZJRFVBTCJdfSwicmVzb3VyY2VfYWNjZXNzIjp7ImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyIsInZpZXctcHJvZmlsZSJdfX0sInNjb3BlIjoicHJvZmlsZSBlbWFpbCIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwibmFtZSI6IlRlc3QxMTAwMDYgQXV0bzExMDAwNiIsInByZWZlcnJlZF91c2VybmFtZSI6IjExMDAwNiIsImdpdmVuX25hbWUiOiJUZXN0MTEwMDA2IiwiZmFtaWx5X25hbWUiOiJBdXRvMTEwMDA2IiwiZW1haWwiOiIxMTAwMDZAeHl6LmNvbSJ9.MED2OvCIgs8aL2z9zPfvwxvCYU-zuywD5Mp9Z43nDwmYWbRBRp3jq2Y4JuY5uXFU-P-eC4FSER5213dWFOFOs6wF_eV9OP7r7eb397Nclq1N63Hsii1qvgPJ-NJ2q_ZjGucFJFRAj-WBVMsT4c2k_2AT0cCk4j8ZGoCIh2CJZSvH1QgOrU6_iEsgyc11uPZB9rxeYx2v-RQNgs0DD09K2hN5i25KIJtSctagQ0kyCHwESbU9LwtZhRbXIK1ph1capG8Wa_TNdAjWCGF6A7P109oJx-GqYqtjn8OWsn6iSkVX4h2tS9yzzJOHGKoJoXSLUGGXZJo_ZJ-2Vxr1a_vppg",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"id\": \"mosip.resident.vid\",\r\n  \"request\": {\r\n \"individualId\": \"{{UIN}}\",\r\n    \"individualIdType\": \"UIN\",\r\n    \"otp\": \"111111\",\r\n    \"transactionID\": \"1234567890\",\r\n    \"vidType\": \"Perpetual\"\r\n  },\r\n  \"requesttime\": \"2020-09-30T06:20:22.404Z\",\r\n  \"version\": \"v1\"\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{url}}/resident/v1/vid",
							"host": [
								"{{url}}"
							],
							"path": [
								"resident",
								"v1",
								"vid"
							]
						},
						"description": "1) perpetual VID is generated new number everytime you generated VID, by revoking the OLD one automatically.\r\n2) "
					},
					"response": []
				},
				{
					"name": "VID auth",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									""
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"postman.setEnvironmentVariable(\"signaturevid\",postman.getResponseHeader(\"signature\") );\r",
									"var resbody = pm.response.json();\r",
									"console.log(resbody);\r",
									"//postman.setEnvironmentVariable(\"reqbody\",resbody);\r",
									"\r",
									"//let reqbody=pm.environment.set(\"reqbody\",jsonData);\r",
									"pm.environment.set(\"vidreqbody\", JSON.stringify(resbody));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": " {\r\n    \"demographics\": {\r\n        \"dob\": \"{{DateofBirth}}\"\r\n                    },\r\n    \"timestamp\": \"{{requesttime}}\",\r\n    \"transactionID\": \"1234567890\"\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "localhost:8082/v1/identity/createAuthRequest?id={{VID}}&idType=VID",
							"host": [
								"localhost"
							],
							"port": "8082",
							"path": [
								"v1",
								"identity",
								"createAuthRequest"
							],
							"query": [
								{
									"key": "id",
									"value": "{{VID}}"
								},
								{
									"key": "idType",
									"value": "VID"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "IDAuth Request Copy",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"fail\", function () {\r",
									"    pm.expect(pm.response.text()).to.include(\"false\");\r",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"name": "Content-Type",
								"type": "text",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"type": "text",
								"value": "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJRWFE5S0FyUlNpckJaSmVQQ2JyeFh1dl90ODNXUXdPTGVCYV8yWFhoQzk4In0.eyJqdGkiOiIxNTE4NzE2OS1jZmJmLTQwOTAtOTlkOS0wMzBjYjhiYTAwNTEiLCJleHAiOjE2MDMzOTE1OTUsIm5iZiI6MCwiaWF0IjoxNjAzMzU1NTk1LCJpc3MiOiJodHRwczovL3FhLm1vc2lwLm5ldC9rZXljbG9hay9hdXRoL3JlYWxtcy9tb3NpcCIsImF1ZCI6ImFjY291bnQiLCJzdWIiOiJiZjdlNGRjYS0yYWRhLTQzN2YtYTdjOC03Mzg1NzMwZjhmMDkiLCJ0eXAiOiJCZWFyZXIiLCJhenAiOiJtb3NpcC1yZWdwcm9jLWNsaWVudCIsImF1dGhfdGltZSI6MCwic2Vzc2lvbl9zdGF0ZSI6IjQyZTY0M2UwLWNlMmUtNDVmYi04ZGVjLWZiOWQxZGVkNWUxNCIsImFjciI6IjEiLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsiUkVHSVNUUkFUSU9OX1BST0NFU1NPUiIsIlJFR0lTVFJBVElPTl9BRE1JTiIsIkNSRURFTlRJQUxfUkVRVUVTVCIsIkNSRUFURV9TSEFSRSIsIm9mZmxpbmVfYWNjZXNzIiwiREFUQV9SRUFEIiwiTUVUQURBVEFfUkVBRCIsIkRPQ1VNRU5UX1JFQUQiLCJ1bWFfYXV0aG9yaXphdGlvbiIsIkJJT01FVFJJQ19SRUFEIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19LCJtb3NpcC1yZWdwcm9jLWNsaWVudCI6eyJyb2xlcyI6WyJ1bWFfcHJvdGVjdGlvbiJdfX0sInNjb3BlIjoiZW1haWwgcHJvZmlsZSIsImNsaWVudElkIjoibW9zaXAtcmVncHJvYy1jbGllbnQiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsImNsaWVudEhvc3QiOiIxMC4yNDQuMy40NCIsInByZWZlcnJlZF91c2VybmFtZSI6InNlcnZpY2UtYWNjb3VudC1tb3NpcC1yZWdwcm9jLWNsaWVudCIsImNsaWVudEFkZHJlc3MiOiIxMC4yNDQuMy40NCJ9.Zg1D74pqKS46cPqU241_vKe7BinyLVqYxU2wE5glSVCEfpntUMi5QgxxMPdVqgi2gk9rFZS4qH3kCsTmptGkAL2LAZpM090tF7NPOtyfskR-pOvaY1nT08DnJkuaxdb9SsfSQRNUOTqqPbqlL08Zl0ItidypP_Ppt6ySH-VjLXWb_lE5TjCjcPHZvT4B24aqAW6_bAeDXJsf9QtX1dgUUA07pUxgWETq7MjtfFa3ZKfLlacm7wpyuYY5r5fBsxcaXAla9tkUjGB7QJK944feUZYuMzqEf-EznV8x2Lv-l7RnHcxWXr9te0ec9o6DqKSrEy030LoW-fMdrnSAWWAi2g"
							},
							{
								"key": "signature",
								"value": "{{signaturevid}}",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{{vidreqbody}}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{url}}/idauthentication/v1/auth/{{RPMISPkey}}/{{PARTNERID}}/{{APIkey}}",
							"host": [
								"{{url}}"
							],
							"path": [
								"idauthentication",
								"v1",
								"auth",
								"{{RPMISPkey}}",
								"{{PARTNERID}}",
								"{{APIkey}}"
							]
						}
					},
					"response": []
				}
			]
		}
	]
}